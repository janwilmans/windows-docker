(function($)
{jQuery.fn.shake=function(intShakes,intDistance,intDuration){this.each(function(){$(this).css({position:"relative"});for(var x=1;x<=intShakes;x++){$(this).animate({left:(intDistance*-1)},(((intDuration/intShakes)/4))).animate({left:intDistance},((intDuration/intShakes)/2)).animate({left:0},(((intDuration/intShakes)/4)));}});return this;};(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id)){return;}
js=d.createElement(s);js.id=id;js.src="//connect.facebook.net/zh_TW/all.js";fjs.parentNode.insertBefore(js,fjs);}(document,'script','facebook-jssdk'));if(dpr.fbswitch==='on'){window.fbAsyncInit=function(){FB.init({appId:dpr.fbid,xfbml:true,version:'v2.7'});};}
$.fn.depcSubmitComment=function(options)
{var settings=$.extend({id:0,editor:0,nounce:'',reply:true,selector:'',logged:'',captcha:null},options);if(settings.reply===false){initAddComment();}else if(settings.reply===true){initAddReplyComment();}else if(settings.reply===1){commentReplySaveButton();}
function initAddComment(){$(".dpr-discu-container_"+settings.id+" "+settings.selector).on('click',function(){var $this=$(this),recaptcha='',gemail,gname,gwebsite,getcaptcha;var html_data;var raw_data;if(typeof(human_data)==="undefined"||human_data===null){human_data='';}
html_data=tinyMCE.activeEditor.getContent();if(html_data===''||html_data==='undefined'){$('.mce-tinymce').css('border','1px solid red');$('.mce-tinymce').shake(2,13,250);return false;}
if(dpr.logged_in==='no'){gname=$('.dpr-submit-form-fields-c-name').val();gemail=$('.dpr-submit-form-fields-c-email').val();gwebsite=$('.dpr-submit-form-fields-c-website').val();getcaptcha=$('#dpr-submit-captcha .g-recaptcha-response').val();if(gname===''||gname==='undefined'){$('.dpr-submit-form-fieldswrap-name').css('border','1px solid red');$('.dpr-submit-form-fieldswrap-name').shake(2,13,250);return false;}
if(gemail===''||gemail==='undefined'){$('.dpr-submit-form-fieldswrap-email').css('border','1px solid red');$('.dpr-submit-form-fieldswrap-email').shake(2,13,250);return false;}
var testEmail=/^[A-Z0-9._%+-]+@([A-Z0-9-]+\.)+[A-Z]{2,4}$/i;if(!testEmail.test(gemail)){$('.dpr-submit-form-fieldswrap-website').css('border','1px solid red');$('.dpr-submit-form-fieldswrap-website').shake(2,13,250);return false;}
if(dpr.captcha==='on'){if($('#dpr-submit-captcha .g-recaptcha-response').length){var response=grecaptcha.getResponse();if(response==0){$('.dpr-submit-form-captcha').css('border','1px solid red');$('.dpr-submit-form-captcha').shake(2,13,250);return false;}}}}
$('.dpr-wrap > .dpr-preloader-wrap').css('display','block');var jqXhr=$.ajax({type:"POST",url:dpr.adminajax,data:{action:'dpr_add_comment',security:settings.nounce,post_id:settings.id,comment_data:html_data,gemail:gemail,gname:gname,gwebsite:gwebsite,recaptcha:getcaptcha},});$.when(jqXhr).done(function(data){$('.dpr-wrap > .dpr-preloader-wrap').css('display','none');if(data.status==='publish'){tinyMCE.activeEditor.setContent('');setTimeout(function(){$('.dpr-wrap > .dpr-preloader-wrap').css('display','none');$(data.data).prependTo(".dpr-discu-container_"+settings.id+" .dpr-discu-main-loop-wrap");var target=$("#comments-"+data.newcomment_id);$('html,body').animate({scrollTop:target.offset().top},800);},400);$('.dpr-submit-form-editor').removeAttr('style');}else{$.alert({text:dpr.ok,title:dpr.duplicate,content:data.data,});}});});}
function initAddReplyComment(){$(document).on('click',".dpr-discu-container_"+settings.id+" "+settings.selector,function(e){e.preventDefault();bindAddReplyComment();var $this=$(this);if($this.attr('data-clicked')==='not'){$this.attr('data-clicked','clicked');$this.trigger('click');}});}
function bindAddReplyComment(){var selector_spn='',selector_btn='';$(".dpr-discu-container_"+settings.id+" "+settings.selector).toggle(function(e){e.preventDefault();var $this=$(this),comment_id=$this.data('id'),parent_id=$this.data('parent'),recaptcha='',fields='';if(comment_id===parent_id){selector_btn='.dpr-tinymce-button:first';selector_spn='.dpr-tinymce-replies:first';}else{selector_spn='.dpr-tinymce-replies';selector_btn='.dpr-tinymce-button';}
dpr_tinymce(".dpr-discu-wrap_"+comment_id+" .dpr-discu-replies-wrap "+selector_spn,100,false,'small');tinymce.execCommand('mceFocus',false,".dpr-discu-wrap_"+comment_id+" .dpr-discu-replies-wrap "+selector_spn);if(dpr.captcha==='on'&&dpr.logged_in==='no')recaptcha='<div class="dpr-replies-captcha" id="dpr-captcha-'+comment_id+'"></div>';if(dpr.logged_in==='no'){fields='<div class="dpr-submit-form-fields"><span class="dpr-submit-form-fields-c dpr-submit-form-fieldswrap-name"><i class="sl-user"></i><input class="dpr-submit-form-fields-c-name" type="text" name="name" placeholder="Name"></span><span class="dpr-submit-form-fields-c dpr-submit-form-fieldswrap-email"><i class="sl-envelope-open"></i><input class="dpr-submit-form-fields-c-email" type="email" name="email" placeholder="Email"></span><span class="dpr-submit-form-fields-c dpr-submit-form-fieldswrap-website"><i class="sl-compass"></i><input class="dpr-submit-form-fields-c-website" type="text" name="website" placeholder="Website"></span></div>';}
$(".dpr-discu-wrap_"+comment_id+" .dpr-discu-replies-wrap "+selector_btn).append(fields+recaptcha+'<a href="#" data-id="'+comment_id+'" data-parent="'+parent_id+'" class="dpr_add_reply_comment">'+dpr.save_comment+'</a> <a href="#" data-id="'+comment_id+'" data-parent="'+parent_id+'" class="dpr_cancle_reply_comment">'+dpr.cancle+'</a>');if(dpr.captcha==='on'&&dpr.logged_in==='no'){grecaptcha.render('dpr-captcha-'+comment_id,{'sitekey':dpr.recaptcha,'theme':dpr.recaptcha_theme,'size':dpr.recaptcha_size});}},function(){var $this=$(this),comment_id=$this.data('id');if(dpr.logged_in==='no'){$(".dpr-discu-wrap_"+comment_id+" .dpr-discu-replies-wrap "+selector_btn).empty();}
$(".dpr-discu-wrap_"+comment_id+" .dpr-discu-replies-wrap "+selector_btn+" .dpr_add_reply_comment , .dpr-discu-wrap_"+comment_id+" .dpr-discu-replies-wrap "+selector_btn+" .dpr_cancle_reply_comment , .dpr-discu-wrap_"+comment_id+" .dpr-discu-replies-wrap "+selector_btn+" #dpr-captcha-"+comment_id).remove();tinymce.remove(".dpr-discu-wrap_"+comment_id+" .dpr-discu-replies-wrap "+selector_spn);});}
function commentReplySaveButton(){$(document).on('click',".dpr-discu-container_"+settings.id+" "+settings.selector,function(event){event.preventDefault();var comment_id=$(this).data('id');var parent_id=$(this).data('parent');var recaptcha='';html_data=tinyMCE.activeEditor.getContent();var selector='#comments-'+comment_id+' .dpr-discu-replies-wrap ';gname=$(selector+'.dpr-submit-form-fields-c-name').val();gemail=$(selector+'.dpr-submit-form-fields-c-email').val();gwebsite=$(selector+'.dpr-submit-form-fields-c-website').val();recaptcha=$('#dpr-captcha-'+comment_id+' .g-recaptcha-response').val();var validate=validate_forms(dpr.logged_in,dpr.captcha,selector,html_data,gname,gemail,recaptcha);if(validate===false){return false;}
$('#comments-'+parent_id+' > .dpr-preloader-wrap').css('display','block');$.ajax({type:"POST",url:dpr.adminajax,data:{action:'dpr_add_comment',security:settings.nounce,comment_id:comment_id,post_id:settings.id,comment_data:html_data,recaptcha:recaptcha,gname:gname,gemail:gemail,gwebsite:gwebsite},success:function(data){$('#comments-'+parent_id+' > .dpr-preloader-wrap').css('display','none');if(data.status==='publish'){setTimeout(function(){$(data.data).insertAfter(".dpr-discu-wrap_"+parent_id+" .dpr-discu-box-footer .dpr-discu-replies-wrap:first");},400);}else{}
if(comment_id===parent_id)$(".dpr-discu-wrap_"+comment_id+" .dpr-discu-box-footer .dpr-discu-reply-btn-wrap .dpr-discu-reply-btn").first().trigger('click');else $(".dpr-discu-wrap_"+comment_id+" .dpr-discu-box-footer .dpr-discu-reply-btn-wrap .dpr-discu-reply-btn").trigger('click');$(".dpr-discu-wrap_"+comment_id+" .dpr-discu-replies-wrap .dpr-tinymce-replies p").html('');remove_form(selector);setTimeout(function(){var target=$("#comments-"+data.newcomment_id);target=target.length?target:$('[name='+this.hash.substr(1)+']');if(target.length){$('html,body').animate({scrollTop:target.offset().top},800);return false;}},401);},error:function(jqXHR,textStatus,errorThrown){setTimeout(function(){$('#comments-'+parent_id+' > .dpr-preloader-wrap').css('display','none');},100);}});});}};$.fn.depcEditComment=function(options)
{var settings=$.extend({id:0,save:true,nounce:''},options);if(settings.save==false){commentEditButton();}else if(settings.save===true){commentEditSaveButton();}else if(settings.save===null){commentDeleteButton();}else if(settings.save===-1){commentFlagButton();}else if(settings.save===-2){commentSocialButton();}
function commentEditButton(){$(document).on('click',".dpr-discu-container_"+settings.id+" .dpr-discu-wrap .dpr-discu-box-header-icons .dpr-discu-edit",function(event){event.preventDefault();toggledit();var $this=$(this);if($(".dpr-discu-wrap_"+$this.data('id')+" .dpr-discu-text:first .edit-"+settings.id)!='mce_0'){$this.trigger('click');}});}
function toggledit(){$(".dpr-discu-container_"+settings.id+" .dpr-discu-wrap .dpr-discu-box-header-icons .dpr-discu-edit").toggle(function(){var $this=$(this);var comment_id=$this.data('id');dpr_tinymce(".dpr-discu-wrap_"+comment_id+" .dpr-discu-text:first .edit-"+comment_id,100,false,'small');$(".dpr-discu-wrap_"+comment_id+" .dpr-discu-text:first").append('<a href="#" data-id="'+comment_id+'" class="dpr_edit_comment">'+dpr.save_comment+'</a> <a href="#" data-id="'+comment_id+'" data-parent="'+comment_id+'" class="dpr_cancle_comment">'+dpr.cancle+'</a>');tinymce.execCommand('mceFocus',false,"dpr-discu-wrap_"+comment_id+" .dpr-discu-text:first .edit-"+comment_id);},function(){var $this=$(this);var comment_id=$this.data('id');$(".dpr-discu-wrap_"+comment_id+" .dpr-discu-text:first .dpr_edit_comment , .dpr-discu-wrap_"+comment_id+" .dpr-discu-text:first .dpr_cancle_comment").remove();tinymce.remove(".dpr-discu-wrap_"+comment_id+" .dpr-discu-text:first .edit-"+comment_id);});}
function commentEditSaveButton(){$(document).on('click','.dpr-discu-container_'+settings.id+' .dpr-discu-wrap .dpr_edit_comment',function(event){event.preventDefault();var $this=$(this);var comment_id=$this.data('id');html_data=tinyMCE.activeEditor.getContent();raw_data=tinyMCE.activeEditor.getContent({format:"text"});$('#comments-'+comment_id+' > .dpr-preloader-wrap').css('display','block');$.ajax({type:"POST",url:dpr.adminajax,data:{action:'dpr_edit_comment',security:settings.nounce,comment_id:comment_id,content:html_data},success:function(data){$('#comments-'+comment_id+' > .dpr-preloader-wrap').css('display','none');$(".dpr-discu-wrap_"+comment_id+" .dpr-discu-text .dpr_edit_comment , .dpr-discu-wrap_"+comment_id+" .dpr-discu-text .dpr_cancle_comment").remove();tinymce.remove(".dpr-discu-wrap_"+comment_id+" .dpr-discu-text .edit-"+comment_id);$(".dpr-discu-wrap_"+comment_id+" .dpr-discu-text .edit-"+comment_id).empty();$(".dpr-discu-wrap_"+comment_id+" .dpr-discu-text .edit-"+comment_id).append(html_data);},error:function(jqXHR,textStatus,errorThrown){setTimeout(function(){$('#comments-'+comment_id+' > .dpr-preloader-wrap').css('display','none');},100);}});});}
function commentDeleteButton(){$(document).on('click','.dpr-discu-container_'+settings.id+' .dpr-discu-wrap .dpr-discu-delete',function(event){event.preventDefault();var $this=$(this);var comment_id=$this.data('id');$.confirm({content:dpr.sure_delete,title:dpr.delete_cm,type:'red',rtl:dpr.rtl,animation:'bottom',closeAnimation:'top',theme:'modern',buttons:{ok:{text:dpr.delete,btnClass:'btn-primary',keys:['enter'],action:function(){$('#comments-'+comment_id+' > .dpr-preloader-wrap').css('display','block');$.ajax({type:"POST",url:dpr.adminajax,data:{action:'dpr_delete_comment',security:settings.nounce,comment_id:comment_id},success:function(data){$('#comments-'+comment_id+' > .dpr-preloader-wrap').css('display','none');$('.dpr-discu-wrap_'+comment_id).fadeOut(800);},error:function(jqXHR,textStatus,errorThrown){setTimeout(function(){$('#comments-'+comment_id+' > .dpr-preloader-wrap').css('display','none');},100);}});}},cancel:{text:dpr.cancle,action:function(){}}}});});}
function commentFlagButton(){$(document).on('click','.dpr-discu-container_'+settings.id+' .dpr-discu-wrap .dpr-discu-flag',function(event){event.preventDefault();var $this=$(this);var comment_id=$this.data('id');$.confirm({content:dpr.sure_flag,title:dpr.flag_cm,type:'red',rtl:dpr.rtl,animation:'bottom',closeAnimation:'top',theme:'modern',buttons:{ok:{text:dpr.ok,btnClass:'btn-primary',keys:['enter'],action:function(){$('#comments-'+comment_id+' > .dpr-preloader-wrap').css('display','block');$.ajax({type:"POST",url:dpr.adminajax,data:{action:'dpr_flag_comment',security:settings.nounce,comment_id:comment_id},success:function(data){$('#comments-'+comment_id+' > .dpr-preloader-wrap').css('display','none');$.alert({text:dpr.ok,title:dpr.flag_cm,content:data.message,});},error:function(jqXHR,textStatus,errorThrown){setTimeout(function(){$('#comments-'+comment_id+' > .dpr-preloader-wrap').css('display','none');},100);}});}},cancel:{text:dpr.cancle,action:function(){}}}});});}
function commentSocialButton(){$(document).on('click','.dpr-discu-container_'+settings.id+' .dpr-discu-metadata-share-wrap .dpr-discu-sharing .dpr-discu-social-icon a',function(event){event.preventDefault();var $this=$(this),comment_id=$this.data('id');var child=parseInt($('.dpr-discu-wrap .dpr-c-contents .dpr-discu-metadata-share-wrap .dpr-discu-share .dpr-discu-share-count-'+comment_id).html());$('.dpr-discu-wrap .dpr-c-contents .dpr-discu-metadata-share-wrap .dpr-discu-share .dpr-discu-share-count-'+comment_id).text(child+1);$.ajax({type:"POST",url:dpr.adminajax,data:{action:'dpr_social_comment',security:settings.nounce,comment_id:comment_id},success:function(data){if(data.resp==0){$('.dpr-discu-wrap .dpr-discu-metadata-share-wrap .dpr-discu-share .dpr-discu-share-count-'+comment_id).text(child-0);}},error:function(jqXHR,textStatus,errorThrown){}});});}};$.fn.depcLoginForm=function(options)
{var settings=$.extend({id:0,nounce:'',register:''},options);if(settings.register==false)initLoginForm();else initRegisterForm();function initLoginForm(){$(".dpr-discu-container_"+settings.id+" .dpr-join-form-login-a").on('click',function(){var $this=$(this);var sing=$.confirm({content:"<div class='dpr-modal-cntt'><div class='dpr-preloader-wrap'><div class='dpr-preloader'></div></div><form id='login' action='login' method='post'><input placeholder='"+dpr.username+"' id='dpr_username' type='text' name='username'><input placeholder='"+dpr.password+"' id='dpr_password' type='password' name='password'></form></div>",title:dpr.login,type:'red',rtl:dpr.rtl,animation:'bottom',closeAnimation:'top',theme:'modern',onOpen:function(){},buttons:{ok:{text:dpr.login,btnClass:'btn-primary',keys:['enter'],action:function(){var username,password;username=$('#dpr_username').val();password=$('#dpr_password').val();if(username===''||username==='undefined'){$('#dpr_username').css('border','1px solid red');$('.jconfirm-content-pane').shake(2,13,250);return false;}
if(password===''||password==='undefined'){$('#dpr_password').css('border','1px solid red');$('.jconfirm-content-pane').shake(2,13,250);return false;}
$('.dpr-modal-cntt .dpr-preloader-wrap').css('display','block');$.ajax({type:"POST",url:dpr.adminajax,data:{action:'dpr_login',security:settings.nounce,post_id:settings.id,dpr_username:username,dpr_password:password},success:function(data){$('.dpr-modal-cntt .dpr-preloader-wrap').css('display','none');if(data.error==true){$('.dpr-notify').remove();sing.setContentAppend('<div class="dpr-notify">'+data.message+'</div>');}else{$('.dpr-notify').remove();sing.setContentAppend('<div class="dpr-notify">'+data.message+'</div>');setTimeout(function(){location.reload();},500);}},error:function(jqXHR,textStatus,errorThrown){$('.dpr-modal-cntt .dpr-preloader-wrap').css('display','none');}});return false;}},cancel:{text:dpr.cancle,action:function(){}}}});});}
function initRegisterForm(){$(".dpr-discu-container_"+settings.id+" .dpr-join-form-register-a").on('click',function(){var $this=$(this),term='';if(dpr.term_link!==''){term="<label class='checkbox rememberme'><input name='rememberme' type='checkbox' id='rememberme' value='forever'><span>I have read and accept the <a href='"+dpr.term_link+"' target='_blank' class='dpr-modal-terms'>Terms and Conditions</a></span></label>";}
var sing=$.confirm({content:"<div class='dpr-modal-cntt'><div class='dpr-preloader-wrap'><div class='dpr-preloader'></div></div><form id='dpr-register' action='login' method='post'><input type='text' name='name' id='name' placeholder="+dpr.name+"><input type='email' name='email' id='email' placeholder="+dpr.email+"><input type='text' name='username' id='username' placeholder="+dpr.username+"><input id='inputPassword' type='password' name='password' placeholder="+dpr.password+"><input type='password' name='cnfrm_password' placeholder="+dpr.confirm_password+"><span id='complexity' class='default'></span>"+term+"<div class='dpr-modal-footer'><span class='dpr-modal-login-span'>Already have an account? <a href='#' class='dpr-modal-login-a'>"+dpr.login+"</a></span></div></form></div>",title:dpr.singup,type:'red',rtl:dpr.rtl,animation:'bottom',closeAnimation:'top',theme:'modern',onOpen:function(){jQuery("#inputPassword").depcPassStrength();},buttons:{ok:{text:dpr.singup,btnClass:'btn-primary',keys:['enter'],action:function(){if($('#name').val()===''||$('#name').val()==='undefined'){$('#name').css('border','1px solid red');$('.jconfirm-content-pane').shake(2,13,250);return false;}
if($('#email').val()===''||$('#email').val()==='undefined'){$('#email').css('border','1px solid red');$('.jconfirm-content-pane').shake(2,13,250);return false;}
if($('#username').val()===''||$('#username').val()==='undefined'){$('#username').css('border','1px solid red');$('.jconfirm-content-pane').shake(2,13,250);return false;}
if($('#inputPassword').val()===''||$('#inputPassword').val()==='undefined'){$('#inputPassword').css('border','1px solid red');$('.jconfirm-content-pane').shake(2,13,250);return false;}
if(dpr.term_link!==''){if(!jQuery("#rememberme").is(":checked")){$('.rememberme').css('border','1px solid red');$('.jconfirm-content-pane').shake(2,13,250);return false;}}
$('.dpr-modal-cntt .dpr-preloader-wrap').css('display','block');var register=$('#dpr-register').serialize();$.ajax({type:"POST",url:dpr.adminajax,data:{action:'dpr_register',security:settings.nounce,post_id:settings.id,register:register},}).done(function(data){$('.dpr-modal-cntt .dpr-preloader-wrap').css('display','none');if(data.error==true){$('.dpr-notify').remove();$.each(data.message,function(index,el){sing.setContentAppend('<div class="dpr-notify">'+el+'</div>');});}else{$('.dpr-notify').remove();sing.setContentAppend('<div class="dpr-notify">'+data.message+'</div>');setTimeout(function(){location.reload();},1000);}}).fail(function(){$('.dpr-modal-cntt .dpr-preloader-wrap').css('display','none');});return false;}},cancel:{text:dpr.cancle,action:function(){}}}});});}};$.fn.depcPassStrength=function(){var strPassword;var charPassword;var complexity=$("#complexity");var minPasswordLength=8;var baseScore=0,score=0;var num={};num.Excess=0;num.Upper=0;num.Numbers=0;num.Symbols=0;var bonus={};bonus.Excess=3;bonus.Upper=4;bonus.Numbers=5;bonus.Symbols=5;bonus.Combo=0;bonus.FlatLower=0;bonus.FlatNumber=0;outputResult();$("#inputPassword").bind("keyup",checkVal);function checkVal(){init();if(charPassword.length>=minPasswordLength){baseScore=50;analyzeString();calcComplexity();}else{baseScore=0;}
outputResult();}
function init(){strPassword=$("#inputPassword").val();charPassword=strPassword.split("");num.Excess=0;num.Upper=0;num.Numbers=0;num.Symbols=0;bonus.Combo=0;bonus.FlatLower=0;bonus.FlatNumber=0;baseScore=0;score=0;}
function analyzeString(){for(i=0;i<charPassword.length;i++){if(charPassword[i].match(/[A-Z]/g)){num.Upper++;}
if(charPassword[i].match(/[0-9]/g)){num.Numbers++;}
if(charPassword[i].match(/(.*[!,@,#,$,%,^,&,*,?,_,~])/)){num.Symbols++;}}
num.Excess=charPassword.length-minPasswordLength;if(num.Upper&&num.Numbers&&num.Symbols){bonus.Combo=25;}else if((num.Upper&&num.Numbers)||(num.Upper&&num.Symbols)||(num.Numbers&&num.Symbols)){bonus.Combo=15;}
if(strPassword.match(/^[\sa-z]+$/)){bonus.FlatLower=-15;}
if(strPassword.match(/^[\s0-9]+$/)){bonus.FlatNumber=-35;}}
function calcComplexity(){score=baseScore+(num.Excess*bonus.Excess)+(num.Upper*bonus.Upper)+(num.Numbers*bonus.Numbers)+(num.Symbols*bonus.Symbols)+bonus.Combo+bonus.FlatLower+bonus.FlatNumber;}
function outputResult(){if($("#inputPassword").val()==""){complexity.html("").removeClass("weak strong stronger strongest").addClass("default");}else if(charPassword.length<minPasswordLength){complexity.html("At least "+minPasswordLength+" characters please!").removeClass("strong stronger strongest").addClass("weak");}else if(score<50){complexity.html("Weak!").removeClass("strong stronger strongest").addClass("weak");}else if(score>=50&&score<75){complexity.html("Average!").removeClass("stronger strongest").addClass("strong");}else if(score>=75&&score<100){complexity.html("Strong!").removeClass("strongest").addClass("stronger");}else if(score>=100){complexity.html("Secure!").addClass("strongest");}}};$.fn.depcVote=function(options)
{var settings=$.extend({id:0,nounce:'',like:true},options);initLikeDislike();function initLikeDislike(){$(document).on('click',".dpr-discu-container_"+settings.id+" .dpr-discu-box .dpr-discu-box-footer-metadata-like .dpr-cont-discu-"+settings.like+" .dpr-discu-"+settings.like,function(e){e.preventDefault();var $this=$(this);var comment_id=$this.parent().parent().data('id');var child=parseInt($this.children(".dpr-discu-"+settings.like+"-count").text());$this.children(".dpr-discu-"+settings.like+"-count").text(child+1);$.ajax({type:"POST",url:dpr.adminajax,data:{action:'dpr_vote',security:settings.nounce,comment_id:comment_id,like:settings.like},}).done(function(data){if(data!=1){$this.children(".dpr-discu-"+settings.like+"-count").text(child-0);}}).fail(function(){$this.children(".dpr-discu-"+settings.like+"-count").text(child-0);});});}};$.fn.depcFilter=function(options)
{var settings=$.extend({id:0,nounce:'',action:'',type:'',cache_trending:false,cache_popular:false,cache_oldest:false,cache_newest:false},options);if(settings.type==='trending'){initTrending();}else if(settings.type==='popular'){initPopular();}else if(settings.type==='oldest'){initOldest();}else if(settings.type==='newest'){initNewest();}else if(settings.type==='key'){initKeySearch();}
function initTrending(){$(".dpr-discu-container_"+settings.id+" .dpr-switch-tab-wrap .dpr-switch-tab .dpr-switch-tab-trending .dpr-switch-tab-trending-a").on('click',function(e){e.preventDefault();var $this=$(this);if(settings.cache_trending!=false){do_cache($this,settings.cache_trending,settings.id,'trending');return;}
$('.dpr-wrap > .dpr-preloader-wrap').css('display','block');$.ajax({type:"POST",url:dpr.adminajax,data:{action:settings.action,security:settings.nounce,type:settings.type},}).done(function(data){$('.dpr-wrap > .dpr-preloader-wrap').css('display','none');$('.dpr-container .dpr-switch-tab-wrap .dpr-switch-tab li a').removeClass('dpr-active-tab');$this.addClass('dpr-active-tab');$('.dpr-discu-main-loop-wrap').empty();$('.dpr-discu-main-loop-wrap').append(data);$(".dpr-discu-container_"+settings.id+" .dpr-discu-main-loop-wrap .dpr-loadmore-btn").attr('data-type','trending');settings.cache_trending=data;}).fail(function(){$('.dpr-wrap > .dpr-preloader-wrap').css('display','none');});});}
function initPopular(){$(".dpr-discu-container_"+settings.id+" .dpr-switch-tab-wrap .dpr-switch-tab .dpr-switch-tab-popular .dpr-switch-tab-popular-a").on('click',function(e){e.preventDefault();var $this=$(this);if(settings.cache_popular!=false){do_cache($this,settings.cache_popular,settings.id,'popular');return;}
$('.dpr-wrap > .dpr-preloader-wrap').css('display','block');$.ajax({type:"POST",url:dpr.adminajax,data:{action:settings.action,security:settings.nounce,type:settings.type},}).done(function(data){$('.dpr-wrap > .dpr-preloader-wrap').css('display','none');$('.dpr-container .dpr-switch-tab-wrap .dpr-switch-tab li a').removeClass('dpr-active-tab');$this.addClass('dpr-active-tab');$('.dpr-discu-main-loop-wrap').empty();$('.dpr-discu-main-loop-wrap').append(data);$(".dpr-discu-container_"+settings.id+" .dpr-discu-main-loop-wrap .dpr-loadmore-btn").attr('data-type','popular');settings.cache_popular=data;}).fail(function(){$('.dpr-wrap > .dpr-preloader-wrap').css('display','none');});});}
function initOldest(){$(".dpr-discu-container_"+settings.id+" .dpr-switch-tab-wrap .dpr-switch-tab .dpr-switch-tab-oldest .dpr-switch-tab-oldest-a").on('click',function(e){e.preventDefault();var $this=$(this);if(settings.cache_oldest!=false){do_cache($this,settings.cache_oldest,settings.id,'ASC');return;}
$('.dpr-wrap > .dpr-preloader-wrap').css('display','block');$.ajax({type:"POST",url:dpr.adminajax,data:{action:settings.action,security:settings.nounce,type:settings.type,id:settings.id},}).done(function(data){$('.dpr-wrap > .dpr-preloader-wrap').css('display','none');$('.dpr-container .dpr-switch-tab-wrap .dpr-switch-tab li a').removeClass('dpr-active-tab');$this.addClass('dpr-active-tab');$('.dpr-discu-main-loop-wrap').empty();$('.dpr-discu-main-loop-wrap').append(data);$(".dpr-discu-container_"+settings.id+" .dpr-discu-main-loop-wrap .dpr-loadmore-btn").attr('data-type','ASC');settings.cache_oldest=data;}).fail(function(){$('.dpr-wrap > .dpr-preloader-wrap').css('display','none');});});}
function initNewest(){$(".dpr-discu-container_"+settings.id+" .dpr-switch-tab-wrap .dpr-switch-tab .dpr-switch-tab-newest .dpr-switch-tab-newest-a").on('click',function(e){e.preventDefault();var $this=$(this);if(settings.cache_newest!=false){do_cache($this,settings.cache_newest,settings.id,'DESC');return;}
$('.dpr-wrap > .dpr-preloader-wrap').css('display','block');$.ajax({type:"POST",url:dpr.adminajax,data:{action:settings.action,security:settings.nounce,type:settings.type,id:settings.id},}).done(function(data){$('.dpr-wrap > .dpr-preloader-wrap').css('display','none');$('.dpr-container .dpr-switch-tab-wrap .dpr-switch-tab li a').removeClass('dpr-active-tab');$this.addClass('dpr-active-tab');$('.dpr-discu-main-loop-wrap').empty();$('.dpr-discu-main-loop-wrap').append(data);$(".dpr-discu-container_"+settings.id+" .dpr-discu-main-loop-wrap .dpr-loadmore-btn").attr('data-type','DESC');settings.cache_newest=data;}).fail(function(){$('.dpr-wrap > .dpr-preloader-wrap').css('display','none');});});}
function initKeySearch(){var selector=".dpr-discu-container_"+settings.id+" .dpr-switch-tab-wrap .dpr-switch-search-wrap .dpr-discu-search",search_val='';var typingTimer;var doneTypingInterval=1000;$(selector).on('keyup',function(){clearTimeout(typingTimer);search_val=$(this).val();typingTimer=setTimeout(function(){doneTyping(search_val);},doneTypingInterval);});$(selector).on('keydown',function(){clearTimeout(typingTimer);});}
function doneTyping(search_val){$('.dpr-wrap > .dpr-preloader-wrap').css('display','block');$.ajax({type:'POST',url:dpr.adminajax,data:{action:settings.action,security:settings.nounce,type:settings.type,search:search_val,id:settings.id},success:function(data){$('.dpr-wrap > .dpr-preloader-wrap').css('display','none');$('.dpr-discu-main-loop-wrap').empty();$('.dpr-discu-main-loop-wrap').append(data);},error:function(jqXHR,textStatus,errorThrown){$('.dpr-wrap > .dpr-preloader-wrap').css('display','none');$('.dpr-discu-main-loop-wrap').empty();$('.dpr-discu-main-loop-wrap').append(dpr.nocomment);}});}
function do_cache($this,data,id,order){$('.dpr-wrap > .dpr-preloader-wrap').css('display','none');$('.dpr-container .dpr-switch-tab-wrap .dpr-switch-tab li a').removeClass('dpr-active-tab');$this.addClass('dpr-active-tab');$('.dpr-discu-main-loop-wrap').empty();$('.dpr-discu-main-loop-wrap').append(data);$(".dpr-discu-container_"+id+" .dpr-discu-main-loop-wrap .dpr-loadmore-btn").attr('data-type',order);}};$.fn.depcLoadMore=function(options){var settings=$.extend({id:0,nounce:'',action:''},options);initLoadMore();function initLoadMore(){$(document).on('click',".dpr-discu-container_"+settings.id+" .dpr-discu-main-loop-wrap .dpr-loadmore-btn",function(e){e.preventDefault();var $this=$(this);var half_cm=$this.data('comments');var loaded_cm=$this.data('loaded');var type=$this.data('type');$('.dpr-wrap > .dpr-preloader-wrap').css('display','block');$.ajax({type:"POST",url:dpr.adminajax,data:{id:settings.id,action:settings.action,security:settings.nounce,half_cm:half_cm,loaded_cm:loaded_cm,type:type},}).done(function(data){$('.dpr-wrap > .dpr-preloader-wrap').css('display','none');$(data.data).insertAfter('.dpr-container .dpr-discu-main-loop-wrap .dpr-insertafter:last');if(0>=parseInt(data.half_cm)){$this.remove();}
$this.data('comments',data.half_cm).attr('data-comments',data.half_cm);$this.data('loaded',data.loaded_cm).attr('data-loaded',data.loaded_cm);$this.data('type',data.type).attr('data-type',data.type);}).fail(function(){$this.css('display','block');$('.dpr-wrap > .dpr-preloader-wrap').css('display','none');});});}};$.fn.depcHandyJs=function(options){var settings=$.extend({id:0,nounce:'',action:'',mode:'',selector:''},options);if(settings.mode==='copylink'){initCopyLink();}else if(settings.mode==='facebook'){initFacebook();}
function initCopyLink(){$(document).on('click',".dpr-discu-container_"+settings.id+" .dpr-discu-main-loop-wrap .dpr-discu-wrap .dpr-discu-box .dpr-discu-link",function(e){e.preventDefault();});new Clipboard('.dpr-discu-main-loop-wrap .dpr-discu-wrap .dpr-discu-box .dpr-discu-link');}
function initFacebook(){$(document).on('click',settings.selector,function(e){e.preventDefault();var $this=$(this),commentid=$this.attr('data-id'),url=$this.attr('data-link');var content=$.trim($this.parent().parent().parent().parent().parent().siblings('.dpr-discu-text').text());FB.ui({method:'share',href:url,quote:content,},function(response){});});}};$(document).ready(function($){dpr_tinymce('.dpr-add-editor',100,false,'small');$(document).on('click','.dpr-discu-box .dpr-discu-collapse',function(event){event.preventDefault();var comment_id=$(this).data('id');$('.dpr-discu-wrap_'+comment_id+' .dpr-c-contents').toggle('fast');});$(document).on('click','.dpr-discu-wrap .dpr-discu-text .dpr_cancle_comment',function(event){event.preventDefault();var $this=$(this),comment_id=$this.data('id'),parent_id=$this.data('parent'),selector='';$(".dpr-discu-wrap_"+comment_id+" .dpr-discu-box-header .dpr-discu-edit").first().trigger('click');});$(document).on('click','.dpr-discu-wrap .dpr-discu-replies-wrap .dpr_cancle_reply_comment',function(event){event.preventDefault();var $this=$(this),comment_id=$this.data('id'),parent_id=$this.data('parent'),selector='';if(comment_id===parent_id)$(".dpr-discu-wrap_"+comment_id+" .dpr-discu-box-footer .dpr-discu-reply-btn-wrap .dpr-discu-reply-btn").first().trigger('click');else $(".dpr-discu-wrap_"+comment_id+" .dpr-discu-box-footer .dpr-discu-reply-btn-wrap .dpr-discu-reply-btn").trigger('click');});$(document).on('keypress','#dpr-gname, #dpr-gemail, #dpr_username, #dpr_password, #name, #email, #username, #inputPassword, #rememberme, .dpr-submit-form-fields-c-name, .dpr-submit-form-fields-c-email',function(){$(this).removeAttr('style');});$(document).on('keypress','.dpr-submit-form-fields-c-name, .dpr-submit-form-fields-c-email ',function(event){$(this).parent().removeAttr('style');});$('.dpr-join-form .dpr-join-form-area textarea').toggle(function(){$('.dpr-submit-form-wrap').css('display','block');tinymce.execCommand('mceFocus',false,'dpr-add-editor');if(grecaptcha&&dpr.captcha==='google'&&dpr.logged_in==='no'){grecaptcha.render('dpr-submit-captcha',{'sitekey':dpr.recaptcha,'theme':dpr.recaptcha_theme,'size':dpr.recaptcha_size});}},function(){$('.dpr-submit-form-wrap').css('display','none');});});function dpr_tinymce(selector,height,status,size){tinymce.init({selector:selector,height:height,branding:false,statusbar:status,theme:'modern',valid_elements:"b,strong,i,em,p,pre[*],code[*],a[*],br",plugins:["wpemoji textcolor colorpicker link paste"],toolbar:"bold | italic | link ",menubar:false,toolbar_items_size:size,style_formats:[{title:'Bold text',inline:'b'},{title:'Red text',inline:'span',styles:{color:'#ff0000'}},{title:'Red header',block:'h1',styles:{color:'#ff0000'}},{title:'Example 1',inline:'span',classes:'example1'},{title:'Example 2',inline:'span',classes:'example2'},{title:'Table styles'},{title:'Table row 1',selector:'tr',classes:'tablerow1'}],inline_styles:false,templates:[{title:'Test template 1',content:'Test 1'},{title:'Test template 2',content:'Test 2'}]});}
function validate_forms(logged,captcha,selector,html_data,gname,gemail,getcaptcha){if(html_data===''||html_data==='undefined'){$(selector+'.mce-tinymce').css('border','1px solid red');$(selector+'.mce-tinymce').shake(2,13,250);remove_mce_style(selector);return false;}
if(logged==='no'){if(gname===''||gname==='undefined'){$(selector+'.dpr-submit-form-fieldswrap-name').css('border','1px solid red');$(selector+'.dpr-submit-form-fieldswrap-name').shake(2,13,250);return false;}
if(gemail===''||gemail==='undefined'){$(selector+'.dpr-submit-form-fieldswrap-email').css('border','1px solid red');$(selector+'.dpr-submit-form-fieldswrap-email').shake(2,13,250);return false;}
var testEmail=/^[A-Z0-9._%+-]+@([A-Z0-9-]+\.)+[A-Z]{2,4}$/i;if(!testEmail.test(gemail)){$(selector+'.dpr-submit-form-fieldswrap-email').css('border','1px solid red');$(selector+'.dpr-submit-form-fieldswrap-email').shake(2,13,250);return false;}
if(captcha==='google'){if($(selector+'#dpr-submit-captcha .g-recaptcha-response').length){var response=grecaptcha.getResponse();if(response==0){$(selector+'.dpr-submit-form-captcha').css('border','1px solid red');$(selector+'.dpr-submit-form-captcha').shake(2,13,250);return false;}}}}
return true;}
function remove_form(selector){if(html_data===''||html_data==='undefined'){$(selector+'.mce-tinymce').css('border','1px solid red');$(selector+'.mce-tinymce').shake(2,13,250);return false;}
gname=$(selector+'.dpr-submit-form-fields').remove();}
function remove_mce_style(input){tinyMCE.activeEditor.on('keypress',function(ed,e){$(input+'.mce-tinymce').css('border','1px solid #e3e3e3');});}}(jQuery));